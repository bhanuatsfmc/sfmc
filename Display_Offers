<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Loyalty Rewards</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
        .card { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { margin-top: 0; }
        .offer { background: #eef4ff; padding: 10px; margin: 10px 0; border-left: 4px solid #3b82f6; }
    </style>
</head>
<body>
    <h2>Your Loyalty Rewards</h2>

    %%[
        SET @customerId = RequestParameter("customerId")

        /* Check if customerId is not empty */
        IF NOT EMPTY(@customerId) THEN
            /* Get contact info */
            SET @contactRows = LookupRows("Contact Info", "ContactId", @customerId)
            IF RowCount(@contactRows) > 0 THEN
                SET @contact = Row(@contactRows, 1)
                SET @name = Field(@contact, "FullName")
                SET @email = Field(@contact, "Email")
                SET @mobile = Field(@contact, "Mobile_Number")

                /* Redact email */
                IF NOT EMPTY(@email) THEN
                    SET @emailParts = BuildRowsetFromString(@email, "@")
                    SET @emailLocal = Field(Row(@emailParts, 1), 1)
                    SET @emailDomain = Field(Row(@emailParts, 2), 1)
                    SET @redactedEmail = CONCAT(Left(@emailLocal, 2), REPEAT("*", Length(@emailLocal)-2), "@", REPEAT("*", Length(@emailDomain)-2), Right(@emailDomain, 2))
                ELSE
                    SET @redactedEmail = "Email not available"
                ENDIF

                /* Redact mobile */
                IF NOT EMPTY(@mobile) THEN
                    SET @redactedMobile = CONCAT("****", Right(@mobile, 4))
                ELSE
                    SET @redactedMobile = "Mobile not available"
                ENDIF
			ENDIF
		ENDIF
 ]%%
                <div class="card">
                    <h3>Customer Info</h3>
                    <p><strong>Name:</strong> %%=v(@name)=%%</p>
                    <p><strong>Email:</strong> %%=v(@redactedEmail)=%%</p>
                    <p><strong>Mobile:</strong> %%=v(@redactedMobile)=%%</p>
                </div>

   
</body>
</html>
